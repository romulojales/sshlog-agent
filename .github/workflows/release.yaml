name: Release
on:
  workflow_dispatch:
        inputs:
                tag:
                        description: 'Version TAG'
                        required: true
                        type: string
jobs:
  
  release-version:
    env:
        TAG_VERSION: ${{github.event.inputs.tag}}
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
        - uses: actions/checkout@v4
        - name: Building Docker Image
          run: |
               docker build -t sshlog-build --target builder .
               
        - name: Extracting RPM and DEB
          run: |
               mkdir -p releases
               docker run -v ./releases:/releases sshlog-build cp /build/sshlog_1.0.0_amd64.deb /releases

        - name: Tagging Repo
          run: |
               git tag -a ${TAG_VERSION} -m  ${TAG_VERSION}

        - name: Releasing
          run: |
               gh release create --verify-tag ${TAG_VERSION} releases/*
               
               
